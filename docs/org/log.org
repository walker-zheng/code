
# -*- org -*-
# -*- coding:utf-8 -*-

# Time-stamp: <2016-07-23 14:25:07 (mykulou@gmail.com)>
#+SETUPFILE: theme-bigblow-local.setup

* the log
** virtualbox和linux基本设置
  - 设置网络为NAT和桥接
  - =VBoxManage startvm "opensuse" –-type headless=
  - 配置更新源，163上有说明
  - 设置 =LC_CTYPE=zh_CN.UTF-8= ，putty使用UTF-8显示
  - 构建工具集autotoolset automake autoconf libtool
  - 配置ssh，统一key，git与github、googlecode连通
  - github上添加自己的public key，使用(ssh+)git
  - 使用https，git push显示RPC失败
** samba设置
  - 配置PDC域管理，支持win域注册
  - 添加smb账号(smbpasswd root)
  - win清楚密码缓存(net use * /d /y)
  - 访问控制(host allow = 192.168.1.1)
  - win无法共享，检查NetBIOS Helper服务
** mysql配置
  - mysql配置
    #+begin_src bash
    mysql_install_db --user=mysql
    mysqld_safe --user=mysql
    mysqladmin -u root -p
    mysql -h opensuse -u root
    #+end_src
  - 配置odbc，提示连接被拒:
    #+begin_src sql
    update user set host = '%' where user = 'root';
    GRANT ALL PRIVILEGES ON *.* TO 'root'@'192.168.1.3' IDENTIFIED BY 'mypassword' WITH GRANT OPTION;
    #+end_src
** WTF openssh on win7/cygwin(solved)
*** cygwin安装
  - 选择安装cygrunsrv,openssh
    - ssh-host-config -y
    - ssh-user-config
    - 在Cygwin.bat添加 set CYGWIN=binmode ntsec
  - 问题
    1 QueryServiceStatus: Win32 error 1062
    2 error NETHELPSMG 3534
  - 解决
    #+begin_src bash
    chmod 700 /var/empty
    chown SYSTEM empty
    #+end_src
  - tips: cygrunsrv -S/E/R sshd #cygwin 服务启停删
  - sc delete 服务名 #win

*** cygwin编译glib
  - 依赖：gettext中的xgettext & msgfmt
     - 下载.bin.woe32.zip包，
       http://www.gnu.org/software/gettext/FAQ.html#windows\_howto
  - make check
    还是有两个test不过，mmap和unicode的,但可以安装进去，过了会，显示有
    点问题。。。
  - 编译安装还是找不到库
    #+begin_src bash
      PKG_CONFIG_PATH="$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig"
      export PKG_CONFIG_PATH
      export TERM=xterm
      export COLORTERM=1
      export LIBDIR=/etc/ld.so.conf
      export LD_RUN_PATH=$LD_RUN_PATH:$LIBDIR
      export PATH=$PATH:$LIBDIR
    #+end_src
  - sdcv编译中有error: ' =libintl_setlocale= ' is not a member of 'std'
    - 调整include的顺序。。。
      https://trac.macports.org/browser/trunk/dports/textproc/sdcv/files/patch-setlocale.diff?rev=85010
  - tip
    打开src/sdcv.cpp中的HAVE_MMAP宏
  - 丢失 msvcr100d.dll
    使用VS调试模式编译的exe会有这问题
  
*** cygwin设置
  - sshd安装，设置，key-copy
  - “tty" option detected in CYGWIN environment variable 修改注册表
    cygwin:
    - =HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\sshd\Parameters\Environment=
    or
    - =HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment=
  
  - cygwin中文设置 可能是由于glib的unicode部分问题，sdcv显示乱码，而
    cygwin正 常，~/.bashrc做如下修改：
    #+begin_src bash
      export LC_ALL=zh_CN.UTF-8
      export LANG=zh_CN.UTF-8
      export LC_CTYPE=zh_CN.UTF-8
      export CHARSET=UTF-8
      export LANG=POSIX
    #+end_src
  - emacs在cygwin上的中文设置(满脸坑)，dos和win32中显示编码是 GBK，
    cygwin用的utf-8，eshell是正常，shell则惨不忍睹，emacs也全都有
    utf-8，做如下修改：
    #+begin_src elisp
    (setq default-process-coding-system '(gbk . utf-8))
    #+end_src
    - tip： 这样eshell中sdcv也正常，sdcv-mode也正常
  
** 代理设置
  - ssh -D代理 =ssh -qTfnN -D 7070 onlybird@ssh2012.unssh.com -p 9999=
  - firefox下，用autoproxy+订阅
  - (chrome lite on android)
  #+begin_src bash
  sqlite3
  /data/data/com.google.android.providers.settings/databases/settings.db
  sqlite> INSERT INTO system VALUES(99,’http_proxy', 'proxy:port');
  sqlite>.exit
  #+end_src
  - (firefox lite on android)
    修改/data/data/org.mozilla.fennec/mozilla/xxxxxxxx.default/prefs.js
  #+begin_src bash
  user_pref("network.proxy.type", 1);
  user_pref("network.proxy.http", "your.proxy.ip");
  user_pref("network.proxy.http_port", your.proxy.port);
  user_pref("network.proxy.ssl", "your.proxy.ip");
  user_pref("network.proxy.ssl_port", your.proxy.port);
  user_pref("network.proxy.share_proxy_settings", true);
  #+end_src
    或者修改about:config中(一次效果):
    - network.proxy.http和network.proxy.ssl
    - =network.proxy.http_port= 和 =netowrk.proxy.ssl_port.network.proxy.type= 为1
    - network.online为false
  
** emacs问题
  - Daemon
    - (server-start)
      - .emacs.d/server is unsafe
      - 检查server的所有者、审核者、权限是否是当前用户
  - linux下设置
   #+begin_src bash
   alias er='emacsclient -s server -t -a ""'
   export EDITOR="er"
   #+end_src
  - 仅用emacsclinet的设置，不是daemon
    - 设置环境变量EMACS_SERVER_FILE和ALTERNATE_EDITOR
    - .emacs中添加：
      #+begin_src elisp
      (setq server-name "server")
      (server-start)
      #+end_src
    - 注册表中添加右键：
      #+begin_text
      [HKEY_CLASSES_ROOT\*\Shell\Open With Emacs\command]
      D:\emacs-23.3\bin\emacsclientw.exe -n "%1"
      #+end_text
  - windows下不支持daemon,变通方案：
    - make-frame-invisible隐藏frame
      #+begin_src elisp
      (defun xy/done ()
        "Make Emacs frame invisible, just like the `emacs --daemon'"
        (interactive)
        (save-some-buffers) ;; Save edited buffers first!
        (server-edit)
        (make-frame-invisible nil t))
      (when (equal system-type 'windows-nt)
       (global-set-key (kbd "C-x C-c") 'xy/done) ;; virtually kill a frame
       (global-set-key (kbd "C-x M-c") 'save-buffers-kill-emacs)) ;; kill emacs
      #+end_src
    
** bash设置
  - stty stop "" #开启C-s搜索
*** 常用命令

    #+begin_src bash
ls | xargs -t -i mv {} {}.bak	#-t 打印操作命令
file * | grep ASCII | cut -d":" -f1 | xargs vi
find . -name "*oraenv*" -type f -exec file {} \;
find . -name "*.trc" -ctime +3 -exec rm -f {} \;
rename .log .log.‘date +%F-%H:%M:%S‘ *
m4 -DCOLOR=brown -DTYPE=broken temp	#字符串替换
skill -STOP oracle	#冻结进程（用户、PID、命令或终端 id）
skill -CONT 16514	#唤醒
snice +4 -u oracle	#降低优先级
    #+end_src
** 其他杂项命令
  - 代码浏览，GNU global & doxygen
    - global & globash
      doxygen可以使用global的引用，可以生成页面浏览
    - =python -m SampleHttpServer= 或者 =python -m http.server=
  - firefox支持磁力链接(文件关联)
    about:config中，添加:
    #+begin_src bash
    network.protocol-handler.external.magnet=true
    network.protocol-handler.app.magnet="D:\uTorrent.exe"
    network.protocol-handler.expose-all=true
    #+end_src
  - 快播设置(去掉：根据相关法律法规，该网站不可点播)
    设置Playlist文件夹权限为拒绝或换成文件
  - cygrunsrv -S/E/R sshd #cygwin 服务启停删
  - =VBoxManage startvm "opensuse" –-type headless=
  - win7全半角切换热键无法修改或禁用
    - 修改 =HKEY_CURRENT_USER\Control Panel\Input Method\Hot Keys\00000011=
  - wget中文下载乱码问题
    - 有人修改代码
    - 或者添加 --restrict-file-names=nocontrol
    - wget -c -r -k -np oss.org.cn/kernel-book
       ## 续传、递归、转链、非父
** win7问题
*** 工具激活失败，没有software protection服务
    - 激活工具：win7loader/小马OEM
    - slui.exe error 0x80070424
      - 安装服务
#+begin_src bash
sc create sppsvc binPath= C:\Windows\System32\sppsvc.exe DisplayName= "Software Protection" depend= Rpcss start= delayed-auto obj= "NT AUTHORITY\NetworkService" password= ""
sc privs sppsvc SeAuditPrivilege/SeChangeNotifyPrivilege/SeCreateGlobalPrivilege/SeImpersonatePrivilege
sc sdset sppsvc D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPLOCRRC;;;IU)(A;;CCLCSWRPLOCRRC;;;SU)(A;;LCRP;;;AU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)
sc sidtype sppsvc UNRESTRICTED
#+end_src
    
** 书
*** 经济
    - 国富论
    - 资本论
    - 人口论
*** 知识
    - 控制论
    - 工程控制论
    - 论自由
    - 孙子兵法
    - 战国策
    - 道德经
    - 论语
    - 哈姆雷特
    - 梦的解析
    - 通往奴役之路
*** epub       
    - 历史研究.epub
    - 枪炮、病菌与钢铁.epub
    - 社会契约论.epub
    - 论法的精神.epub
    - 曼昆经济学原理.epub
    - 如何阅读一本书.epub

    - 生命是什么.epub
    - 爱的艺术.epub
    - 查泰莱夫人的情人.epub

    - 乌合之众—大众心理研究.epub
    - 人性的弱点.epub
    - 梦的解析.epub
    - 世界是平的.epub

    - 每周工作4小时.epub
    - 菊花与刀.epub
    - 西方哲学史.epub
    - 追寻生命的意义.epub
    - 黑客与画家.epub

** 树莓派
*** 配件
    - 主要：无线网卡AP，SD卡(或microsd+卡套)，无线路由
      - 无线适配器，蓝牙适配器，鼠键，蓝牙耳机
      - usb集线器（带电源）
      - hdmi转dvi/av，hdmi线
*** 配置
     1. 下载树莓派镜像
        =http://downloads.raspberrypi.org/images/raspbian/=
     2. 使用dd或Win32DiskImager，将镜像写到SD卡
     3. 连接网线，树莓派会默认启动ssh，可通过ssh接入
        - 拷贝已有key
          #+BEGIN_SRC bash
 scp -r ~/.ssh pi@192.168.1.104:/home/pi
 scp /etc/ssh*g root@192.168.1.104:/etc/ssh
cd ~/.ssh
cp id_rsa /etc/ssh/ssh_host_rsa_key
cp id_rsa.pub /etc/ssh/ssh_host_rsa_key.pub
          #+END_SRC
     4. sudo raspi-config配置，如expand_rootfs扩展整个sd卡
     5. 安装无线网卡驱动(8188eu for TL-WN725N)
        #+BEGIN_SRC bash
lsusb	#查看usb上的网卡型号
sudo cd /boot	#将驱动模块拷到/boot
sudo install -c -m 0644 ./rtl8188eu.ko /lib/modules/3.2.27+/kernel/drivers/net/wireless
sudo depmod -a
sudo modprobe rtl8188eu
        #+END_SRC
     6. 配置网卡
        #+begin_src bash
allow-hotplug wlan0
iface wlan0 inet manual
    wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf	#使用wpa_supplicant的配置文件
address 192.168.1.107					#配置为静态ip
netmask 255.255.255.0
gateway 192.168.1.1
iface default inet dhcp
        #+end_src
        - 使用wpa_passphrase生成密钥，可以保存多个在
          wpa_supplicant.conf中，如
        #+begin_src bash
pi@raspi ~ $ wpa_passphrase MERCURY_3FBCE2
# reading passphrase from stdin
isdjfiwefw
network={
        ssid="MERCURY_3FBCE2"
        #psk="isdjfiwefw"
        psk=13f06892e124ad6758859cccaa239b808be04e41ebe1b3fc260bcb2c45636853
}
        #+end_src
        - 检查和配置网络 =ifconfig= =iwlist scan= =iwconfig wlan0= =dhclient=
     7. 防止/etc/resolv.conf被篡改，chattr +i
     8. 去掉desktop，sudo update-rc.d lightdm stop 2
     9. for freebsd：
        - # alias ls='gnuls --color=auto --show-control-chars' 
     10. 彩色中文显示
         #+begin_src bash
export TERM=xterm-color
export LANG=zh_CN.UTF-8
color_prompt=yes
PS1='${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\] \[\033[01;34m\]\w \$\[\033[00m\] '
         #+end_src bash
     11. 修复系统
         1. 密码忘记：进入到单用户模式，passwd root修改
         2. 系统无法进入：usb挂载到vbox上的linux上，chroot进入系统，修
            改
            #+begin_src bash
# mount /dev/hda5 /mnt/hda5
# chroot /mnt/hda5/
[chroot]# grub-install /dev/hda
/dev/hda: Not found or not a block device.
[chroot]# exit
exit
# mount -o bind /proc /mnt/hda5/proc/
# mount -o bind /dev /mnt/hda5/dev/
# mount -o bind /sys /mnt/hda5/sys
# df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/hda3             9.5G  3.9G  5.1G  44% /
tmpfs                 311M     0  311M   0% /dev/shm
AFS                   8.6G     0  8.6G   0% /afs
/dev/hda1             9.7G  5.0G  4.2G  55% /mnt/hda1
/dev/hda5             9.5G  3.8G  5.3G  42% /mnt/hda5
# chroot /mnt/hda5
[chroot]# grub-install /dev/hda
Installation finished. No error reported.
This is the contents of the device map /boot/grub/device.map.
Check if this is correct or not. If any of the lines is incorrect,
fix it and re-run the script `grub-install'.

# this device map was generated by anaconda
(hd0)     /dev/hda
[chroot]# exit
exit
            #+end_src
     12. 编译网卡模块
         - 使用
           =https://github.com/Red54/linux-shumeipai2/tree/sunxi-3.0/drivers/net/wireless/rtl8188eu=
         - 编译参考
           =http://gutspot.com/2013/01/30/%E7%94%A8raspberry-pi%E5%88%B6%E4%BD%9C%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E8%BF%87%E7%A8%8B%E7%9A%84%E6%9C%AD%E8%AE%B02-%E7%BC%96%E8%AF%918188eu%E8%8A%AF%E7%89%87%E7%9A%84%E6%97%A0%E7%BA%BF%E7%BD%91/=
     13. freebsd
     14. 新建swap
         #+begin_src bash
sudo dd if=/dev/zero of=/swapfile1 bs=1024 count=524288
sudo mkswap /swapfile1
sudo chown root:root /swapfile1
sudo chmod 0600 /swapfile1
sudo swapon /swapfile1
sudo vi /etc/fstab	#添加以下内容到fstab文件尾
#/swapfile1 swap swap defaults 0 0
free -m
         #+end_src
** minecraft
* [[file:index.html][wiki]]
